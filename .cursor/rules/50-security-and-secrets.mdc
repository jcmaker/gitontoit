---
description: 보안 / 시크릿
globs:
alwaysApply: true
---

## 원칙

- 시크릿은 **서버에서만** 접근. 클라이언트로 절대 전달 금지.
- 환경변수는 **zod**로 부팅 시 검증(lib/env.ts).
- 제3자 API 토큰은 **최소 권한**(GitHub read-only 등).

## API 안전장치

- 레이트 리밋(사용자/리포 단위), 타임아웃(외부 API 10~15s), 재시도 지수백오프(최대 2~3회).
- 입력 검증(zod), 출력 스키마화.
- 민감 로그 금지(토큰/PII). 에러 로그에도 토큰 마스킹.

## 권한

- 리포 접근은 유저-리포 연결 테이블 검증.
- 멀티테넌시(유저 A가 B의 데이터 접근 불가) 철저히 확인.
